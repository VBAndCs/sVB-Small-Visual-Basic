txtNum.Visible = False

'----------------------------
Sub btnAdd_OnClick  
   lblResult.Text = "Result = " + (txtNum1.Text + txtNum2.Text)
EndSub

'__________________________________
Sub btnSubtract_OnClick  
   lblResult.Text = "Result = " + (txtNum1.Text - txtNum2.Text)
EndSub

'__________________________________
Sub btnMultply_OnClick
   lblResult.Text = "Result = " + (txtNum1.Text * txtNum2.Text)
EndSub

'__________________________________
Sub btnDivide_OnClick   
   if txtNum2.Text = 0 Then        
      Result = "Can't divide by zero."
      txtNum2.SelectAll()
      txtNum2.Focus()
      
   else
      Result = "Result = " + (txtNum1.Text / txtNum2.Text)
   endif
   
   lblResult.Text = Result
EndSub


'----------------------------
Sub txtNum1_OnTextInput
   Validate(txtNum1)
EndSub

'------------------------------------------------
Sub txtNum2_OnTextInput
   Validate(txtNum2)
EndSub


'------------------------------------------------
Sub Validate(txtNum)
   c = Event.LastTextInput
   If Text.IsNumeric(c) = False Then
      If c = "-" Then
         If Text.StartsWith(txtNum.Text, "-") Then
            Sound.PlayBellRing()
            Event.Handled = True
         Else
            txtNum.Select(1, 0)
         EndIf
         
      elseIf c = "." Then
         If Text.Contains(txtNum.Text, ".") Then
            Sound.PlayBellRing()
            Event.Handled = True
         EndIf
         
      Else
         Sound.PlayBellRing()
         Event.Handled = True         
      EndIf      
   EndIf   
EndSub

'------------------------------------------------
lastN1 = 0

Sub txtNum1_OnTextChanged
   lastN1 = Reject(txtNum1, lastN1)
EndSub

'------------------------------------------------
lastN2 = 0

Sub txtNum2_OnTextChanged
   lastN2 = Reject(txtNum2, lastN2)
EndSub

'------------------------------------------------
Function Reject(txtNum, lastN)
   If txtNum.Text = "" Then
      txtNum.Text = "0"
      txtNum.SelectAll()
      
   ElseIf Text.IsNumeric(txtNum.Text) = False Then
      txtNum.Text = lastN
      Sound.PlayBellRing()
      txtNum.SelectAll()
   EndIf
   
   Return txtNum.Text
EndFunction
