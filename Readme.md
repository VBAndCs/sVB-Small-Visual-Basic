# Small Visual Basic (sVB):
sVB is an evolved version of SB with small WinForms library and a graphics form designer. 

![Untitled](https://user-images.githubusercontent.com/48354902/126494834-f6c90190-4241-40c7-84b3-c3b3c432a6d1.png)

It has many enhancements over SB to make writing apps fast and easy  with little code. It brings back the joy and excitement of using vb6 to write RAD applications, by adding the illusion of the Object type while accessing controls members:
```vb
Label1.Text = TextBox1.Text + TextBox2.Text
```
All Label1, TextBox1 and TextBox2 are just string variables, but in sVB you can use the names of the controls as if they are Objects containing the controls themselves, and hence access their properties, methods and events directly, with support of the auto-completion list.

![untitled2](https://user-images.githubusercontent.com/48354902/126494901-60dfa36b-cdaf-4fd0-8107-1769f4e5c4c4.jpg)

You can also add events handlers from the upper dropdown lists: Choose the control name from the left list (say `Button1`), and click the event name from the right list (say `OnClick`), and this sub will added for you in the code editor:
```vb
Sub Button1_OnClick
   
EndSub
```

Or you can simply double-click the button on the form designer, and the Button1_OnClick will be created for you!

To make this work, each form created by the designer has 3 files:
1. a `.xaml` file containing the form design.
2. a `.sb.gen` file, containing sb code defining the vars that hold form and controls names, and adding the events handlers instructions to connect each event with the sub that handles it.
3. a `.sb` file that you write your code in without warring about the other 2 files contents, as they are fully generated by the designer. This makes you write short, simple and clean code, focusing only on the task you are doing. See the [samples folder](https://github.com/VBAndCs/sVB-Small-Visual-Basic/tree/master/Samples).

# Download the language:

Go to the [Releases page](https://github.com/VBAndCs/sVB-Small-Visual-Basic/releases) and download the latest version of vSB.
Follow these instructions:
1. sVB needs .NET framework 4.8. If you don't have it on your PC, download it and install it. https://go.microsoft.com/fwlink/?LinkId=2085155

2. Unzip the `sVB 1.0.zip` file. You will have a `sVB 1.0` folder. Open the folder and double-click `sVB.exe`.
And that it. You are ready to go :)

# Try the samples:
1. Right-click the form designer and click `Open` from the context menu. 
2. In the `open file dialog`, Navigate to the `sVB 1.0\Samples` folder and open any sample folder. 
3. Select the `.xaml` file from the folder and click the `Open` button. This will open the form in the designer.
4. Click the `Form code` tab at the top of the window to switch to the sb code editor.
5. Click the `Run` button (or hit F5 from keyboard) to run the program.

# Why do we need sVB:
BASIC is famous of being easy to learn because its simple syntax is close to natural English. In 2008, MS released Small Basic for kids of 7 years old and above. It was really small, containing only 14 keywords to perform the basic programming instructions like If, For, while and Goto statements.

Small basic is a dynamic language, as you don't declare variables with types. You just assign a value to a valid identifier and SB will declare it as a Primitive variable, which can hold a string, a number, or an array.
This makes the language very easy to learn and use for kids.

But, a programming language is not just instructions. It has to have a class library to communicate with Windows. In fact SB comes with a number of powerful libraries, and allow you to supply your own libraries as well. This is where I saw a big issue while trying to teach SB to my nephews:
The language is too easy,  but using the libraries isn't that easy, especially when dealing with graphics and UI. The PDF book comes with SB makes it hard by focusing on drawing shapes by using the geometric functions (it even contains a fractals sample!)

This is not the best way to introduce programming for kids. A black command window (the TextWindow) is easy but boring, While using vector graphics or drawing using the Turtle within the Graphics Window is amazing but can be quite hard.

The good news is that the Controls class  allows you to draw a TextBox, and a Button on the GraphicsWindow, deal with their properties and handle their events. But, unfortunately, the kid has to design the form blindly by adding controls by code, and even worst,  the code used to communicate with these controls is verbose, because SB doesn't have the Object type, so, you can only store the name of the control in a variable:
```vb
btn = Controls.AddButton("Enable", 100, 100)
Controls.ButtonClicked = OnClick
```

and send this variable to the each method you use to alter the control:
```VB
Sub OnClick
   If Controls.GetButtonCaption(btn) = "Enable" Then
      Controls.SetButtonCaption(btn, "Disable")
   Else
      Controls.SetButtonCaption(btn, "Enable")
   EndIf
EndSub
```

This is not the kind of code you want to show to a kid!
In fact it will be easier to teach Visual Basic to the kid, so he can drag a button form the toolbox, drop on the window, set it's name and caption from the properties window, double-click it to go to it's click event handler in the code editor, and just write:
```vb
   If btn.Text = "Enable"
      btn.Text = "Disable"
   Else
      btn.Text = "Enable"
   EndIf
```

And that's it. Fast, clean, easy and  short code, that made us love programming!

It is unbelievable that SB complicate such an easy task, in the name of being simple and easy to learn for kids!

I looked at some SB alternative IDEs but they either more complex (too advanced to do nothing important with a language meant to be a leering toy), or simple enough to draw the controls and generate some code for them but still can't overcome the SB syntax limitations when dealing with objects.
This is when I decides to do something, and here we are.

# Form designer Features:
Will write this later, but the form designer is too easy to use, so, enjoy trying it.

Warning: don't use the `Diagram Text` submenu from the context menu, because these properties are not supported yet in runtime. I am working on a fix (the Diagram Viewer you see in the source code but is not used yet).

# SB Code Enhancements:
I made a little improvements to the SB compiler:
1. Support array initializers:

You can use the `{}` to set elements to the array at once:
```vb
x = {1, 2, 3}
```

Nested initializers are also supported when you deal of muli-dimension arrays:
```vb
y = {"a", "b", {1, 2, 3}}
```

you can also use vars inside the initializer, so, the above code can be rewritten as:
```vb 
y = {"a", "b", x}
```

And you can send an initialize as a param to a function:
```vb
TextWindow.WriteLine({"Adam", 11, "Succeeded"})
```

2. `For Next` and `While Wend`:

SB uses `EndFor` and `EndWhile` to close `For` and `While` blocks respectively. This is still supported in sVB but I allowed also to use `Next` to close `For` and `Wend` to close `While`, as they are used in VB6. I encourage you to use Next and Wend, ad they give the meaning of repeating and circulating the loop. End gives the meaning of finishing and exiting, so, it is suitable in `EndIf` and `EndSub`, but confusing in `EndFor` and `EndWhile`, as they can imply that `the loop finishes here`, not just `the block ends here`!

3. You can use `Me` to refer to the current Form.

5. The editor auto completes the If, For, While, and Sub blocks just after writing space after them.

6. The editor has a better auto-indentation than SB.

# ToDo:
- Add more controls to the winForms library.
- Support multi-from programs. Right now you can define other forms by code, but this will bring you back to the verbose code similar to SB's controls code. The designer can already open multiple forms, but I need to add the concept of the Project, and change SB compiler to add multiple modules in the Exe, so it can compile multiple form files into one exe.

